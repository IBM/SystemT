-----------------------------------------------------------------------------
-- leftContextTokBug.aql
--
-- Test case for bug #140069: LeftContextTok doesn't work for Chinese document
-----------------------------------------------------------------------------
require document with columns text Text;

-- RESHMA: abbreviation.dict inlined.
create dictionary AbbreviationsDict with case exact
as (
    'B.A.','B.Sc.','B.Eng.','LL.B.','B.F.A.','B.Mus.','B.Ed.',
    'lic. theol.','lic. iur.','lic. rer.','lic. rer.','M.A.',
    'LL.M.','Mag. rer.','Mag. theol.','Mag. iur.','Dipl.-Betriebsw.',
    'Dipl.-Bibl.','Dipl.-Bioinf.','Dipl.-Bioing.','Dipl.-Biomath.',
    'Dipl.-Chem.','Dipl.-Des.','Dipl.-Dok.','Dipl.-Dolm.',
    'Dipl.-oec.-troph.','Dipl.-Finw.','Dipl.-Forsting.','Dipl.-Freizeitwiss.',
    'Dipl.-Ges.oec.','Dipl.-Immobilienw.','Dipl.-Inf.','Dipl.-Inform.',
    'Dipl.-Inf.-Wirt.','Dipl.-Infw.','Dipl.-Ing.','Dipl.-Journ.',
    'Dipl.-Kffr.','Dipl.-Kfm.','Dipl.-Komm.Psych.','Dipl.-Kunsttherap.',
    'Dipl.-Logist.','Dipl.-Math.','Dipl.-Medieninform.','Dipl.-Medienök.',
    'Dipl.-Medienw.','Dipl.-Museol.','Dipl.-Musiktherap.','Dipl.-Naut.',
    'Dipl.-Pfl.','Dipl.-Pflegew.','Dipl.-Pflegepäd.','Dipl.-Red.',
    'Dipl.-Rel.-päd.','Dipl.-Rest.','Dipl.-Reha-psych.','Dipl.-Rpfl.',
    'Dipl.-Soz.arb.','Dipl.-Soz.jur.','Dipl.-Soz.Päd.','Dipl.-Techn.',
    'Dipl.-Übers.','Dipl.-Verw.','Dipl.-Verw.-Betriebsw.','Dipl.-Volksw.',
    'Dipl.-Wirt.-Inf.','Dipl.-Wi.-Inform.','Dipl.-Wirtsch.-Ing.',
    'Dipl.-Wirt.-Ing.','Dipl.-Wi.Jur.','Dipl.-Wirtschaftspsych.','Dipl.-Anim.',
    'Dipl.-Arch.','Dipl.','Dipl.-Des.','u.','Dipl.-Film. u.','Dipl.-Filmkomp.',
    'Dipl.','Dipl.-Ing.','Dipl.-Kam.','Dipl.-Rest.','Dipl. Mus.','Dipl.-Mus.-Päd.',
    'Dipl.-Musikl.','Dipl.-Schau.','Dipl.-Schnittm.','Dipl.-Szeneb.','Dipl.-Szenem.',
    'Dipl.-Tonm.','Dipl. Vis.','Dipl.agr.oec.','Dipl.-Angl.','Dipl.-Arch.',
    'Dipl.-Berufspäd.','Dipl.-Betriebsw.','Dipl.-Bibl.','Dipl.-Biochem.',
    'Dipl.-Biol.','Dipl.-Biol.','Dipl.-Biotechnol.','Dipl.-Chem.','Dipl.-Demogr.',
    'Dipl.-Des.','Dipl.-Dolm.','Dipl.-Forstw.','Dipl.-Geogr.','Dipl.-Geol.',
    'Dipl.-Geoökol.','Dipl.-Geophys.','Dipl.-Germ.','Dipl.-Geront.','Dipl.-Ges.oec.',
    'Dipl.-Ghl.','Dipl.','Dipl.-Gwl.','Dipl.-Gyml.','Dipl.-Hdl.','Dipl.-Hist.',
    'Dipl. human.','Dipl.-Hydrol.','Dipl.-Inf.','Dipl.-Inform. Med.','Dipl.-Ing.',
    'Dipl.-Ing. Univ.','Dipl.-Ing. oec.','Dipl.-Ing. Päd.','Dipl.-iur.','Dipl.-Journ.',
    'Dipl.-Kff.','Dipl.-Kfm.','Dipl.-Kfm. t.o.','Dipl.-Krim.','Dipl.-Krim.',
    'Dipl.-Kult.','Dipl.-Kult.Päd.','Dipl.-Landsch.-ökol.','Dipl.-LMChem.','Dipl.-LM-Ing.',
    'Dipl.-Ling.','Dipl.-Logist.','Dipl.-Math.','Dipl.-Math. oec.','Dipl.-Math.techn.',
    'Dipl.-Med.','Dipl.-Vet.-Med.','Dipl.-Med. Päd.','Dipl.-Medieninf.','Dipl.-Medienprakt.',
    'Dipl.-Medienwiss.','Dipl.-Met.','Dipl.-Mot.','Dipl.-NanoSc.','Dipl.-Mikrobiol.',
    'Dipl.-Mil.','Dipl.-Min.','Dipl.-Nat.','Dipl.oec.troph.','Dipl.oec.','Dipl.-Ök.',
    'Dipl.-Orient.','Dipl.-Oz.','Dipl.-Päd.','Dipl.-Pharm.','Dipl.-Phil.','Dipl.-Phys.',
    'Dipl.-Phys.Ing.','Dipl.-Phys.oec.','Dipl.-Pol.','Dipl.-Prähist.','Dipl.-Psych.',
    'Dipl.-Reg.-Wiss.','Dipl.-Reh.-Päd.','Dipl. rer.','Dipl. rer.','Dipl.rer.pol.',
    'Dipl.-Rom.','Dipl.sc.pol.Univ.','Dipl.-Sicherheits.-Ing.','Dipl.-Soz.Ök.','Dipl.-Soz.',
    'Dipl.-Sozialpäd.','Dipl.-Sozw.','Dipl.-Soz.Wiss.','Dipl.-Sporting.','Dipl.-Sportl.',
    'Dipl.-SpOec.','Dipl.-Sportwiss.','Dipl.-Sprechwiss.','Dipl.-Staatswiss.','Dipl.-Stat.',
    'Dipl.-Stom.','Dipl.-Stomat.','Dipl.-Systemwiss.','Dipl.-Tech. Math.','Dipl.-Technoinform.',
    'Dipl.-Theol.','Dipl.-Troph.','Dipl.-Umweltwiss.','Dipl.-Verk.wirtsch.','Dipl.-Verw. Wiss.',
    'Dipl.-Volksw.','Dipl.-Wirt.','Dipl.-Wirtschaftschem.','Dipl.-Wirt.-Inf.','Dipl.-Wirt. Inform.',
    'Dipl.-Wirtsch.-Inf.','Dipl.-Wi.-Ing.','Dipl.-Wirt.-Ing.','Dipl.-Wirtsch.-Ing.','Dipl.iur.oec.univ.',
    'Dipl.-Wirtl.','Dipl.-Wipäd.','Dipl.-oec.','bzw.','r.','Dr. biol. hom.','Dr. cult.',
    'Dr. disc. pol.','Dr.-Ing.','Dr. iur.','Dr. iur. utr.','Dr. iur. can.','Dr. iur.','Dr. math.',
    'Dr. med.','Dr. med. dent.','Dr. med. vet.','Dr. nat.','Dr. nat. techn.','Dr. oec.',
    'Dr. oec. publ.','Dr. oec. troph.','Dr. paed.','Dr.','Dr. phil.','Dr. phil.',
    'Dr. phil. nat.','Dr.','Dr. rer. agr.','Dr. rer. biol.','Dr. rer. biol.','Dr. rer. cult.',
    'Dr. rer. cur.','Dr. rer. forest.','Dr. rer. hort.','Dr. rer. medic.','Dr. rer. med.',
    'Dr. rer. merc.','Dr. rer. mont.','Dr. rer. nat.','Dr. rer. oec.','Dr. rer. pol.',
    'Dr. rer. physiol.','Dr. rer. publ.','Dr. rer. sec.','Dr. rer. silv.','Dr. rer. soc.',
    'Dr. rer. tech.','Dr. sc. agr.','Dr. sc. hum.','Dr. sc. mus.','Dr. sc. oec.','Dr. sc. soc.',
    'Dr. sc. techn.','Dr.','Dr. theol.','Dr. troph.','Dres.','Dr. habil.','Drs.','Dr. des.',
    '(Dr. theol.','Dr.','Dr. e. h.','D.','M.A.','M.Sc.','M.Eng.','LL.M.','M.F.A.','M.Mus.',
    'M.Th.','M.Ed.','E.M.P.H.','M.Arch.','M.B.L.','M.C.L.','M.Comp.Sc.','M.Env.Sc.','M.C.E.',
    'M.E.A.M.','M.I.B.','M.O.P.','M.O.M.','M.M.','M.M.I.','M.S.A.','M.P.H.','M.P.M.','M.P.P.',
    'Dr.','Dr.','Dr.','Dr.','Dr.-Ing.','Dr.','Dres.','Dr.','Drs.','Dr.','Dr.','Dr.','D.','a. Chr.',
    'A.C.','a. c.','A.D.','DS.','D.S.','u.f.','et seqq.','et seq.','adv. a.m.','ca. ugf.','cf. vgl.',
    'c.p.','cp. vgl.','c.q.','cr.','cr.','ugf.','c.t.','D.S.','d.v.','sGw.','e.g.','z. B.','al.','etc.',
    'seqq.','ua.','i.a.','u. a.','ibid.','id. ebd.','i.e.','d.h.','l.c.','M.O.','N.B.','N.N. o.','N.N.',
    'nem. con.','op. cit.','p.a. jährl.','pro.','p.m.','ppa.','jährl.','pp. usw.','Kgn.','P.S.',
    'Q.D.','tägl.','Q.E.D.','Q.E.F.','q.v. s.','Kgn.','R.I.P.','scil.','s.p.','sqq.','s.t.','s.v.',
    'v.','v.a.','v.i.','s.o.','viz.','v.s.','s.u.','vs.','v.v.','i.d.R.','B.A.','B.Sc.','B.Eng.',
    'LL.B.','B.F.A.','B.Mus.','B.Ed.','BBA','BBA&E','M.A.','M.Eng.','LL.M.','M.F.A.','M.Mus.','M.Th.',
    'M.Ed.','Am.','Apg.','Bar.','BrJer.','Dan.','Dtn.','Eph.','Esra.','Est.','Ex.','Ez.','Gal.',
    'GebMan.','Gen.','Hab.','Hag.','Hebr.','Hld.','Hos.','Ijob.','Jak.','Jdt.','Jer.','Jes.','Joël.',
    'Joh.','Jona.','Jos.','Jud.','Klgl.','Koh.','Kol.','Laod.','Lev.','Lk.','Mal.','Mi.','Mk.','Mt.',
    'Nah.','Neh.','Num.','Obd.','Offb.','Ps.','Phil.','Phlm.','Ri.','Röm.','Rut.','Sach.','Sir.',
    'Spr.','Tit.','Tob.','Weish.','Zef.','Am:','Apg:','Bar:','BrJer:','Dan:','Dtn:','Eph:','Esra:',
    'Est:','Ex:','Ez:','Gal:','GebMan:','Gen:','Hab:','Hag:','Hebr:','Hld:','Hos:','Ijob:','Jak:',
    'Jdt:','Jer:','Jes:','Joël:','Joh:','Jona:','Jos:','Jud:','Klgl:','Koh:','Kol:','Laod:','Lev:',
    'Lk:','Mal:','Mi:','Mk:','Mt:','Nah:','Neh:','Num:','Obd:','Offb:','Ps:','Phil:','Phlm:','Ri:',
    'Röm:','Rut:','Sach:','Sir:','Spr:','Tit:','Tob:','Weish:','Zef:','Am.:','Apg.:','Bar.:',
    'BrJer.:','Dan.:','Dtn.:','Eph.:','Esra.:','Est.:','Ex.:','Ez.:','Gal.:','GebMan.:','Gen.:',
    'Hab.:','Hag.:','Hebr.:','Hld.:','Hos.:','Ijob.:','Jak.:','Jdt.:','Jer.:','Jes.:','Joël.:',
    'Joh.:','Jona.:','Jos.:','Jud.:','Klgl.:','Koh.:','Kol.:','Laod.:','Lev.:','Lk.:','Mal.:',
    'Mi.:','Mk.:','Mt.:','Nah.:','Neh.:','Num.:','Obd.:','Offb.:','Ps.:','Phil.:','Phlm.:','Ri.:',
    'Röm.:','Rut.:','Sach.:','Sir.:','Spr.:','Tit.:','Tob.:','Weish.:','Zef.:','Kön.','Kön:','Kön.:',
    'Makk.','Makk:','Makk.:','Petr.','Petr:','Petr.:','Sam.','Sam:','Sam.:','Thess.','Thess:',
    'Thess.:','Tim.','Tim:','Tim.:','Abk.','carm.','Ach. Tat.','Ep.','Tact.','Ael.','Thphr.',
    'Aen. Tact.','Aeth.','Afran.','Agenn.','grom.','Ain. takt.','leg.','Ag.','Hept.','Suppl.',
    'Alc. Avit.','an.','APr.','Sens.','Pr.Anecd.','Alex. Polyh.','verm.','Alki.','Od.','Alkm.',
    'Abr.','epist.','hex.','off.','Amm.','APr.','Ampel.','Anaxag.','Anaximen.','Anecd. Bekk.',
    '(hrsg.','Fig.','Tht.','Ant. Lib.','Anth. Pal.','mir.','el.','Antiph.','bzw.','Anton. Lib.',
    'Apic.','Apollon.','Apollon. Dysk.','pron.','kon.','civ.','Hann.','Lib.','Mithr.','Pun.','Sic.',
    'Aps.','Apul.','carm.','socr.','Ar. Did.','Archim.','aren.','con. sphair.','stom.','Aret.','or.',
    'Aristob.','Av.','Lys.','Thesm.','an.','aud.','cat.','div.','eth. Nic.','insomn.','lin. insec.',
    'meteor.','mot. an.','Organ.','phgn.','poet.','resp.','rhet. Alex.','soph. el.','hist.',
    'rhythm.','nat.','Arr.','an.','Epict.','per. p. E.','(per. m.','Astyd.','Athan.','c. Ar.',
    'hist. Ar.','deipn.','Athenag.','Aug.','catech. rud.','corrept.','enchir.','mag.','serm.',
    'spir. litt.','rel.','epit. Caes.','Avian.','Avien.','ora.','1.','2.','3.','4.','5.','6.',
    '7.','8.','9.','10.','11.','12.','13.','14.','15.','16.','17.','18.','19.','20.','21.','A.',
    'Adj.','Adm.','Adv.','al.','Apr.','Asst.','Aug.','B.','Bart.','Bldg.','Brig.','Bros.','C.',
    'Capt.','Cd.','Cmdr.','Co.','Col.','Cia.','C','Cía.','Comdr.','Con.','Corp.','Cpl.','D.',
    'Dec.','DR.','Dr.','E.','Ens.','etc.','F.','Feb.','G.','Gen.','Gov.','H.','Hon.','Hosp.',
    'I.','inc.','Inc.','Insp.','J.','Jan.','Jr.','K.','L.','Lt.','M.','M.','Maj.','Messers.',
    'Messrs.','Miss.','Mlle.','MM.','Mme.','MR.','Mr.','MRS.','Mrs.','MS.','Ms.','Msgr.','Mt.',
    'N.','Nov.','O.','Oct.','Op.','Ord.','P.','Pfc.','Ph.','Prof.','Pt.','Pvt.','Q.','R.',
    'Rep.','Reps.','Res.','Rev.','Rev.','Rt.','S.','Sen.','Sens.','Sept.','Sfc.','Sgt.','Sr.',
    'St.','Supt.','Surg.','T.','U.','V.','v.','vs.','W.','X.','Y.','Yahoo!','Z.','A.A.','A.B.',
    'A.D.C.','A.M.','Arts.','A.R.A.','Academy.','A.R.I.B.A.','A.R.S.A.','B.A.','Bart. Baronet.',
    'B.C.L.','B.D.','B.LL.','B.Sc.','C. Chairman.','C.A. Accountant.','C.B.','C.E. Engineer.',
    'C.I.E.','C.M.','C.M.G.','C.S.I.','D.Arts.','D.A.','D.C.L.','D.D.','D.F.A.','Litt. D.',
    'D.M.','D.M.A.','D.M.L.','D.Sc.','D.S.O.','D.S.W.','Work.','Ebor.','F.C.S.','F.D.','F.F.P.S.',
    'F.G.S.','F.K.Q.C.P.I.','F.L.S.','F.M. Marshal.','F.P.S.','F.R.A.S.','Society.','C.P.',
    'F.R.C.P.E.','F.R.C.S.','Surgeons.','F.R.G.S.','F.R.H.S.','F.R.Hist.Soc.','F.R.I.B.A.','F.R.S.',
    'F.R.S.A.','F.R.S.E.','F.R.S.L.','F.S.A.','F.S.S.','F.Z.S.','G.C.B.','G.C.H.','G.C.I.E.',
    'G.C.M.G.','G.C.S.I.','G.C.V.O.','H.H.','H.I.H.','H.I.M.','H.M.','H.R.H.','H.S.H.','J.','J.C.D.',
    'J.D.','J.U.D.','J.P.','K.C.','K.C.B.','K.C.I.E.','K.C.M.G.','K.C.S.I.','K.C.V.O.','K.G.',
    'K.P.','K.T.','L.A.H.','L.C.C.','L.C.J.','L.J.','L.L.A.','LL.B.','LL.D.','LL.M.','L.R.C.P.',
    'L.R.C.S.','L.S.A.','M.A.','M.B.','M.C.','M.D.','M.Inst.C.E.','M.P.','M.R.','M.R.C.P.',
    'M.R.C.S.','M.R.I.A.','Mus.B.','Mus.D.','M.V.O.','N.P.','O.M.','P.C.','Ph.D.','P.P.','P.R.A.',
    'R.','R. I.','R.A.','R.A.M.','R.E.','Reg. Prof.','R.M.','R.N.','S. St.','S.J.','S.S.C.',
    'S.T.B.','S.T.D.','S.T.L.','S.T.P.','V.C.','V.G.','V.S.','W.S.','ac.','bar.','bus.','c.',
    'ft.','cwt.','deg.','dr.','dram.','dwt.','l.','lb. lb.','m.','sc.','sq. ft.','&c.','st.',
    'yd.','A.','A.C.','a/c.','acct.','A.D.','A.E.I.O.U.','Aet.','Aetat.','A.H.','A.M.','A.M.',
    'Anon.','A.U.C.','A.V.','b.','B.V.M.','B.C.','c.','C.','L.','Cf.','Ch.','Chapter.','C.M.S.',
    'Co.','C.O.D.','Cr.','curt.','d.','D.G.','God.','Do.','D.O.M.','Dr.','D.V.','O.E.','e.g.',
    'etc.','Ex.','F.','fec.','fl.','Fo.','f.o.b.','G.P.O.','H.M.S.','Ib.','Ibid.','Id.','i.e.'
    ,'I.H.S.','I.M.D.G.','Inf.','Inst.','I.O.U.','i.q.','k.t.l.','L.','Lat.','l.c.','Lon.','Long.',
    'L.S.','Mem.','Memorandum.','MS.','MSS.','N.B.','N.B.','N.D.','nem.','con.','No.','N.S.',
    'N.T.','ob.','Obs.','O.H.M.S.','O.S.','O.S.B.','O.T.','P.','Pp.','e.g.','P.M.','P.O.','P.O.O.',
    'p.p.','P.P.C.','P.R.','prox.','P.S. Postscript.','Pt. Part.','p.t.','tem.','P.T.O.','Qy.',
    'q.d.','Q.E.D.','Q.E.F.','q.s.','quant.','suff.','q.v.','R. @.','sqrt.','R.I.P.','R.S.V.P.',
    'sc.','Sc. Sculp.','S.D.U.K.','seq.','seqq. sqq.','sp.','S.P.C.K.','S.P.G.','A.','A.A.','AA.',
    'AAA.','A.A.A.F.F.','A.A.V.','A.C.','A.D.','A.D.V.','A.D.A.','AEO.','AIM.','AER.','AER.P.',
    'A.F.','AG.','A.G.','A.L.E.','A.MILL.','AN.','ANN.','ANT.','A.O.','AP.','A.P.','A.P.F.','A.P.M.',
    'A.P.R.C.','ARG.','AR.V.V.D.D.','TER.','A.T.M.D.O.','AV.','A.V.','A.V.C.','AVG.','AVGG.','AVGGG.',
    'AVT.PR.R.','B.','B.','B.A.','B.B.','B.D.','B.DD.','B.D.S.M.','B.F.','B.F.','B.H.','B.I.',
    'B.I.I.','B.M.','B.N.','BN.H.I.','B.P.','B.Q.','B.RP.N.','BRT.','B.T.','B.V.','B.V.V.','BX.',
    'C.','C.B.','C.C.','C.C.C.','C.C.F.','CC.VV.','C.D.','CES.','CESS.','C.F.','C.H.','C.I.','CL.',
    'CL.V.','C.M.','CN.','COH.','COL.','COLL.','COM.','CON.','COR.','COS.','COSS.','C.P.','C.R.',
    'CS.','C.V.','CVR.','D.','D.C.','D.D.','D.D.D.','D.E.R.','DES.','D.I.','D.M.','D.O.M.','D.P.S.',
    'E.','EG.','E.M.','EQ.M.','E.R.A.','F.','F.C.','F.D.','F.F.F.','FL.','F.L.','FR.','F.R.','G.P.R.',
    'H.','HER.','HERC.','H.L.','H.M.','H.S.E.','H.V.','I.','IA.','I.C.','ID.','I.D.M.','I.E.','I.F.',
    'I.H.','IM.','IMP.','I.N.R.I.','I.O.M.','I.P.','I.S.V.P.','K.','KL.','L.','LB.','L.D.D.D.','LEG.',
    'LIB.','LL.','L.M.','L.S.','LVD.','LV.P.F.','M.','M\'.','M.D.','MES.','MESS.','M.F.','M.I.','MON.',
    'M.P.','M.S.','MVN.','MV.','M.V.S.','N.','NEP.','N.F.C.','N.L.','N.M.V.','NN.','N.N.','NNR.','NOB.',
    'NOV.','N.P.','O.','OB.','O.C.S.','O.H.F.','O.H.S.S.','OR.','O.T.B.Q.','P.','P.C.','P.F.','P.M.',
    'P.P.','PR.','P.R.','P.R.C.','PR.PR.','P.S.','P.V.','Q.','Q.D.R.','Q.I.S.S.','Q.S.S.S.','QQ.',
    'Q.R.','R.','R.C.','RP.','RP.','S.','SAC.','S.C.','S.D.','S.D.M.','SER.','S.E.T.L.','SN.','S.P.',
    'S.P.Q.R.','S.S.','T.','TIB.','TRB.','T.F.','TM.','T.P.','TVL.','V.','VA.','V.C.','V.E.','V.F.',
    'V.P.','V.R.','V.S.L.M.','adj.','abbrev.','abl.','Abp.','acc.','Acous.','act.','adv.','Agric.',
    'Alban.','Alg.','Amer.','Am.','Am. Cyc.','Anal. Geom.','Anat.','Anc.','Angl. Ch.','Antiq.','aor.',
    'Ar.','Arch.','Arch. Pub.','Soc.','Pub.','Arith.','Armor.','AS.','Anglo-Saxon.','Astrol.',
    'Astron.','aug.','Bank.','Beau.','Fl.','B.','Fl.','Bib.','Bib.','Bibliog.','Biol.','Bisc.',
    'B. Jon.','Bk.','Com.','Blackw. Mag.','Bohem.','Bot.','Bp.','C.','Braz.','Brit.','Brit. Quar.',
    'Rev.','Burl.','C.','Cant.','Carp.','Catal.','Cath. Dict.','Celt.','cf.','Ch.','Chald.','Chem.',
    'Ch. Hist.','Chin.','Chron.','Civ.','Class.','Class. Myth.','Col.','coll.','Com.','comp.',
    'compar.','conj.','Con. Sect.','contr.','Copt.','Corn.','Cotgr.','Cyc. Med.','Crim.','Crystallog.',
    'Cyc.','D.','Dan.','dat.','def.','Deut.','Dial.','dim.','Diosc.','Disp.','Disus.','Dom. Econ.',
    'Univ.','Mag.','Dyn.','E.','Eccl.','Eccl. Hist.','Ecclus.','Eclec. Rev.','Ed. Rev.','e. g.','Egypt.',
    'Elect.','emph.','Encyc.','Encyc. Amer.','Encyc. Crit.','Encyc. Dict.','Eng.','Eng.','Eng. Cyc.',
    'Engin.','Eol.','Ephes.','equiv.','Esd.','esp.','Etch.','Eng.','Ethnol.','etymol.','Exod.','Ezek.',
    'F.','fem.','Fahr.','Far.','Feud.','Fig.','Fin.','For. Quart.','Rev.','Fort.','Fr.','fr.','freq.',
    'Fries.','fut.','G.','Gael.','Gal.','Gal.','Galv.','gen.','Geneal.','Gent. Mag.','Geog.','Geol.',
    'Geom.','Ger.','Gk.','Goth.','Gov.','Gr.','Gram.','Gris.','Gun.','H.','Hab.','Hag.','Ham. Nav.',
    'Encyc.','Heb.','Her.','Hind.','Hipp.','Hist.','Horol.','Hort.','Hung.','Hydraul.','Hydros.',
    'hypoth.','i. e.','Icel.','Illust.','imp.','Imp. Dict.','incho.','ind.','indef.','inf.',
    'intens.','interj.','Internat. Cyc.','Ion.','i. q.','Ir.','Isa.','Jap.','Jas.','Jav.','Jer.',
    'Join.','Josh.','Judg.','K.','L.','L.','Lam.','Lapp.','Lat.','LD.','Lett.','Lev.','LG.','LGr.',
    'Linn.','lit.','Lit.','Lith.','LL.','M.','masc.','Maced.','Mach.','Mad.','Mag.','Mal.','Malay.',
    'Man.','Manuf.','Mar.','Math.','Matt.','ME.','Mech.','Med.','Metal.','Metaph.','Meteor.','mgr.',
    'MHG.','Micros.','Mil.','Min.','Mir.','Mag.','MLG.','Moham.','W.','Mus.','Myst.','Myth.','N.',
    'n.','Nat. Hist.','Nat. ord.','Naut.','Nav.','Navig.','N. Brit.','Rev.','Neh.','neut.','Am.',
    'Cyc.','Month.','Mag.','NF.','NGr.','NHeb.','NL.','nom.','Norm. F.','Am.','Rev.','Norw.',
    'Num.','Numis.','O.','Ob.','obs.','Obsoles.','OCelt.','OD.','ODan.','OE.','OF.','OFelm.',
    'OFries.','OGael.','OGr.','OHG.','OIcel.','OIt.','OL.','Olr.','ON.','OLG.','OPer.','OPg.',
    'OPol.','Opt.','orig.','Ornith.','OS.','OSlav.','OSp.','Oxf. Gloss.','p.','p. a.','Paint.',
    'Paleon.','pass.','Pathol.','P. Cyc.','Per.','perh.','pers.','Persp.','Pert.','Peruv.',
    'Pet.','Pg.','Pharm.','Phil.','Philem.','Philol.','Philos.','Phon.','Photog.','Photom.','Phren.',
    'Phys.','Phys. Sci.','Physiol.','pl.','Poet.','Pol.','Pol. Econ.','Polit. Econ.','Pop. Sci.','pp.',
    'P.','p.p.','p.ple.','Pr.','Pref.','pref.','prep.','pres.','pret.','prin.','Print.','priv.','prob.',
    'pron.','prop.','Pros.','prov.','Prov.','Prov.','Psa.','Pyro.-elect.','Quart. Rev.','q. v.','R.',
    'R. C.','R. C.','Ch.','Rep. Sec.','Rev.','Rev.','Rev. Ver.','Rhet.','R.','R.','Gl.','Rom.','Rom. Cath.',
    'Rom.','R.','Rpts.','Russ.','Sam.','Sam.','Sat. Rev.','Sax.','sc.','Scand.','Sci.','Sci. Am.',
    'Scot.','Script.','Sculp.','Serv.','Shak.','sing.','Skr.','Slav.','Sp.','Specif.','Stat.','subj.',
    'superl.','Surg.','Surv.','Sw.','Syd. Soc.','Lex.','Syn.','Synop.','Syr.','Tart.','Teleg.','term.',
    'Test.','Theol.','Thes.','Tim.','B.','Trans.','Treas.','Trig.','Turk.','Typog.','Univ.','Up.','U. S.',
    'U.S.','U. S.','Disp.','U. S.','Pharm.','U. S.','Int. Rev.','usu.','v.','v.i.','v.t.','var.','vb.n.',
    'Veter.','Vitr.','W.','Wall.','Westm. Cat.','Westm. Rev.','Zech.','Zeph.'
);


-- detag the document if it contains html or xml tags

detag Document.text as DetaggedDoc
detect content_type never;

create view Doc as 
select Chomp(D.text) as text from DetaggedDoc D;
  
-- add sentence boundary detection
create view Sentences as
extract
    split using B.boundary
        retain right split point
        on B.text
        as sentenceText
from (
    extract
        D.text as text,
        regex /(([\.\?!]+[\s]*)|(\n\s*\n))/ on D.text as boundary
        from Doc D
    -- Filter the candidate boundaries.
    having Not(ContainsDict('AbbreviationsDict',
            CombineSpans(LeftContextTok(boundary, 1), boundary)))
) B;

output view Sentences;